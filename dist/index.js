!function(e){var t={};function n(r){if(t[r])return t[r].exports;var s=t[r]={i:r,l:!1,exports:{}};return e[r].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)n.d(r,s,function(t){return e[t]}.bind(null,s));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.Key=void 0,function(e){e.Up="ArrowUp",e.Down="ArrowDown",e.Left="ArrowLeft",e.Right="ArrowRight"}(r=t.Key||(t.Key={}));!function(e){const t={};Object.keys(e).forEach(n=>{const r=e[n];t[r]=n})}(r);t.default=class{constructor(){this.state=new Map}press(e){this.state.set(e,!0)}release(e){this.state.set(e,!1)}pressed(e){return this.state.get(e)||!1}}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Key=t.World=t.system=t.Entity=void 0;const s=r(n(2));t.Entity=s.default;const o=r(n(3));t.system=o.default;const i=r(n(4));t.World=i.default;const u=n(0);Object.defineProperty(t,"Key",{enumerable:!0,get:function(){return u.Key}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(){this.id=function(){let e=r;return r+=1,Date.now().toString(16)+(1e8*Math.random()|0).toString(16)+e}(),this.components=new Map}add(e){const t=e.constructor;this.components.set(t,e)}remove(e){this.components.delete(e)}has(e){return this.components.has(e)}get(e){return this.components.get(e)}print(){const e=[...this.components];console.log(JSON.stringify({id:this.id,components:e},null,4))}};let r=0},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=(e,t)=>({filter:e,tick:t})},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=r(n(0));function o(e,t){return t.every(t=>e.has(t))}t.default=class{constructor(e,t,n){this.canvas=e,this.context=e.getContext("2d"),this.mouse={x:-100,y:-100},this.systems=n,this.entities=new Map,this.keyboard=new s.default,this.createEntityMapping(t),this.createMouseListener(),this.createKeyboardListener()}add(e){this.entities.forEach((t,n)=>{o(e,n)&&t.set(e.id,e)})}removeEntity(e){this.entities.forEach(t=>{t.delete(e)})}tick(){this.systems.forEach(e=>{const t=Array.from(this.entities.get(e.filter).values());return e.tick(t,this)})}createEntityMapping(e){this.systems.forEach(t=>{const n=new Map;(function(e,t){return Object.values(e).filter(e=>o(e,t))})(e,t.filter).forEach(e=>{n.set(e.id,e)}),this.entities.set(t.filter,n)})}createMouseListener(){const e=this.canvas.getBoundingClientRect();this.canvas.addEventListener("mousemove",t=>{this.mouse.x=t.clientX-e.left,this.mouse.y=t.clientY-e.top})}createKeyboardListener(){document.body.addEventListener("keydown",e=>{this.keyboard.press(e.key)}),document.body.addEventListener("keyup",e=>{this.keyboard.release(e.key)})}}}]);